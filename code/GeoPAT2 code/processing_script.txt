#This reads the data set into GeoPAT2. The input for this step is the preprocessed and normalised raster data from the "QGIS Processing Guide". 
gpat_gridts -i"./prec_mm_4326_01_cropped_rescaled.tif"  -i"./aermr02_kgkg_4326_01_cropped_rescaled.tif" -i"./temperature_C_4326_01_cropped_rescaled.tif"  -i"./TOW_frequency_2019_01_cropped_rescaled.tif" -i"./wet_monthly_2019_01_cropped_rescaled.tif" -i"./uvb_jm2_4326_01_cropped_rescaled.tif"  -i"./prec_mm_4326_02_cropped_rescaled.tif"  -i"./aermr02_kgkg_4326_02_cropped_rescaled.tif"  -i"./temperature_C_4326_02_cropped_rescaled.tif"  -i"./TOW_frequency_2019_02_cropped_rescaled.tif" -i"./wet_monthly_2019_02_cropped_rescaled.tif" -i"./uvb_jm2_4326_02_cropped_rescaled.tif" -i"./prec_mm_4326_03_cropped_rescaled.tif"  -i"./aermr02_kgkg_4326_03_cropped_rescaled.tif"  -i"./temperature_C_4326_03_cropped_rescaled.tif"  -i"./TOW_frequency_2019_03_cropped_rescaled.tif" -i"./wet_monthly_2019_03_cropped_rescaled.tif" -i"./uvb_jm2_4326_03_cropped_rescaled.tif" -i"./prec_mm_4326_04_cropped_rescaled.tif"  -i"./aermr02_kgkg_4326_04_cropped_rescaled.tif"  -i"./temperature_C_4326_04_cropped_rescaled.tif"  -i"./TOW_frequency_2019_04_cropped_rescaled.tif" -i"./wet_monthly_2019_04_cropped_rescaled.tif" -i"./uvb_jm2_4326_04_cropped_rescaled.tif"  -i"./prec_mm_4326_05_cropped_rescaled.tif"  -i"./aermr02_kgkg_4326_05_cropped_rescaled.tif"  -i"./temperature_C_4326_05_cropped_rescaled.tif"  -i"./TOW_frequency_2019_05_cropped_rescaled.tif" -i"./wet_monthly_2019_05_cropped_rescaled.tif" -i"./uvb_jm2_4326_05_cropped_rescaled.tif"  -i"./prec_mm_4326_06_cropped_rescaled.tif"  -i"./aermr02_kgkg_4326_06_cropped_rescaled.tif" -i"./temperature_C_4326_06_cropped_rescaled.tif"  -i"./TOW_frequency_2019_06_cropped_rescaled.tif" -i"./wet_monthly_2019_06_cropped_rescaled.tif" -i"./uvb_jm2_4326_06_cropped_rescaled.tif" -i"./prec_mm_4326_07_cropped_rescaled.tif"  -i"./aermr02_kgkg_4326_07_cropped_rescaled.tif" -i"./temperature_C_4326_07_cropped_rescaled.tif"  -i"./TOW_frequency_2019_07_cropped_rescaled.tif" -i"./wet_monthly_2019_07_cropped_rescaled.tif" -i"./uvb_jm2_4326_07_cropped_rescaled.tif" -i"./prec_mm_4326_08_cropped_rescaled.tif" -i"./aermr02_kgkg_4326_08_cropped_rescaled.tif" -i"./temperature_C_4326_08_cropped_rescaled.tif"  -i"./TOW_frequency_2019_08_cropped_rescaled.tif" -i"./wet_monthly_2019_08_cropped_rescaled.tif" -i"./uvb_jm2_4326_08_cropped_rescaled.tif" -i"./prec_mm_4326_09_cropped_rescaled.tif" -i"./aermr02_kgkg_4326_09_cropped_rescaled.tif" -i"./temperature_C_4326_09_cropped_rescaled.tif"  -i"./TOW_frequency_2019_09_cropped_rescaled.tif" -i"./wet_monthly_2019_09_cropped_rescaled.tif" -i"./uvb_jm2_4326_09_cropped_rescaled.tif" -i"./prec_mm_4326_10_cropped_rescaled.tif"  -i"./aermr02_kgkg_4326_10_cropped_rescaled.tif" -i"./temperature_C_4326_10_cropped_rescaled.tif"  -i"./TOW_frequency_2019_10_cropped_rescaled.tif" -i"./wet_monthly_2019_10_cropped_rescaled.tif" -i"./uvb_jm2_4326_10_cropped_rescaled.tif" -i"./prec_mm_4326_11_cropped_rescaled.tif"  -i"./aermr02_kgkg_4326_11_cropped_rescaled.tif" -i"./temperature_C_4326_11_cropped_rescaled.tif"  -i"./TOW_frequency_2019_11_cropped_rescaled.tif" -i"./wet_monthly_2019_11_cropped_rescaled.tif" -i"./uvb_jm2_4326_11_cropped_rescaled.tif" -i"./prec_mm_4326_12_cropped_rescaled.tif"  -i"./aermr02_kgkg_4326_12_cropped_rescaled.tif" -i"./temperature_C_4326_12_cropped_rescaled.tif"  -i"./TOW_frequency_2019_12_cropped_rescaled.tif" -i"./wet_monthly_2019_12_cropped_rescaled.tif" -i"./uvb_jm2_4326_12_cropped_rescaled.tif" -o allmonths_gridts  -d 6

#This command creates the query signatures for each ETS location based on the data set included in the code above
gpat_pointsts -i allmonths_gridts -o querey_signatures.txt --xy_file="Existing_coordinates.txt"

#This command compares the query signatures created above to all other cells in the data set by means of Dynamic Time Warping
gpat_search -i allmonths_gridts -r querey_signatures.txt -m tsDTW

